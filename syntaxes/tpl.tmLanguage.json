{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"scopeName": "source.tpl",
	"injections": {
		"L:meta.embedded.js.tpl - string, L:meta.embedded.html.tpl - string": {
			"patterns": [
				{
					"include": "$self"
				}
			]
		}
	},
	"patterns": [
		{
			"name": "comment.tpl",
			"begin": "{#",
			"end": "#}"
		},
		{
			"begin": "{%\\bjavascript\\b%}",
			"beginCaptures": {
				"0": {
					"patterns": [
						{
							"include": "#punctuations"
						},
						{
							"include": "#keywords"
						}
					]
				}
			},
			"end": "{%\\bendjavascript\\b%}",
			"endCaptures": {
				"0": {
					"patterns": [
						{
							"include": "#punctuations"
						},
						{
							"include": "#keywords"
						}
					]
				}
			},
			"contentName": "meta.embedded.js.tpl",
			"patterns": [
				{
					"include": "#js"
				}
			]
		},
		{
			"name": "variable.tpl",
			"begin": "{{",
			"beginCaptures": {
				"0": {
					"name": "punctuation.variable.begin.tpl"
				}
			},
			"end": "}}",
			"endCaptures": {
				"0": {
					"name": "punctuation.variable.end.tpl"
				}
			},
			"patterns": [
				{
					"include": "#variables"
				}
			]
		},
		{
			"name": "expression.tpl",
			"begin": "{%",
			"beginCaptures": {
				"0": {
					"name": "punctuation.expression.begin.tpl"
				}
			},
			"end": "%}",
			"endCaptures": {
				"0": {
					"name": "punctuation.expression.end.tpl"
				}
			},
			"patterns": [
				{
					"include": "#keywords"
				}
			]
		},
		{
			"name": "string.quoted.double.tpl",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.tpl",
					"match": "\\\\."
				},
				{
					"include": "$self"
				}
			]
		},
		{
			"begin": "(<)(script)(?![^/>]*/>\\s*$)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin.html"
				},
				"2": {
					"name": "entity.name.tag.script.html"
				}
			},
			"end": "(</)(script)(>)",
			"endCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin.html"
				},
				"2": {
					"name": "entity.name.tag.script.html"
				},
				"3": {
					"name": "punctuation.definition.tag.end.html"
				}
			},
			"patterns": [
				{
					"begin": "(>)",
					"beginCaptures": {
						"1": {
							"name": "punctuation.definition.tag.end.html"
						}
					},
					"end": "(?=</script>)",
					"patterns": [
						{
							"include": "#js"
						}
					]
				}
			]
		},
		{
			"begin": "(<)(style)(?![^/>]*/>\\s*$)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin.html"
				},
				"2": {
					"name": "entity.name.tag.style.html"
				}
			},
			"end": "(</)(style)(>)",
			"endCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin.html"
				},
				"2": {
					"name": "entity.name.tag.style.html"
				},
				"3": {
					"name": "punctuation.definition.tag.end.html"
				}
			},
			"patterns": [
				{
					"begin": "(>)",
					"beginCaptures": {
						"1": {
							"name": "punctuation.definition.tag.end.html"
						}
					},
					"end": "(?=</style>)",
					"patterns": [
						{
							"include": "#css"
						}
					]
				}
			]
		},
		{
			"begin": "(<)(\\w+)(?![^/>]*/>\\s*$)",
			"beginCaptures": {
				"1": {
					"name": "punctuation.definition.tag.begin.html"
				},
				"2": {
					"name": "entity.name.tag.html"
				}
			},
			"end": "(</)(\\w+)(?![^/>]*/>\\s*$)",
			"endCaptures": {
				"1": {
					"name": "punctuation.definition.tag.end.html"
				}
			},
			"name": "meta.embedded.html.tpl",
			"patterns": [
				{
					"begin": "(>)",
					"beginCaptures": {
						"1": {
							"name": "punctuation.definition.tag.end.html"
						}
					},
					"end": "(?=>)",
					"patterns": [
						{
							"include": "#html"
						}
					]
				}
			]
		}
	],
	"repository": {
		"punctuations": {
			"patterns": [
				{
					"name": "punctuation.expression.begin.tpl",
					"match": "{%"
				},
				{
					"name": "punctuation.expression.end.tpl",
					"match": "%}"
				},
				{
					"name": "punctuation.comment.begin.tpl",
					"match": "{#"
				},
				{
					"name": "punctuation.comment.end.tpl",
					"match": "#}"
				},
				{
					"name": "punctuation.variable.begin.tpl",
					"match": "{{"
				},
				{
					"name": "punctuation.variable.end.tpl",
					"match": "}}"
				}
			]
		},
		"keywords": {
			"patterns": [
				{
					"name": "keyword.conditional.tpl",
					"match": "\\b(if|else|endif)\\b"
				},
				{
					"name": "keyword.tag.tpl",
					"match": "\\b(javascript|endjavascript)\\b"
				},
				{
					"include": "#operations"
				}
			]
		},
		"operations": {
			"patterns": [
				{
					"name": "keyword.operation.tpl",
					"match": "\\s+(=|!=|\\-|\\+|\\/|\\*)+\\s"
				}
			]
		},
		"variables": {
			"patterns": [
				{
					"name": "variable.value.tpl",
					"match": "\\w+"
				},
				{
					"include": "#operations"
				}
			]
		},
		"js": {
			"patterns": [
				{
					"include": "source.js"
				}
			]
		},
		"css": {
			"patterns": [
				{
					"include": "source.css"
				}
			]
		},
		"html": {
			"patterns": [
				{
					"include": "text.html.derivative"
				}
			]
		}
	}
}
